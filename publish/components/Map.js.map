{"version":3,"sources":["../../src/components/Map.js"],"names":["Map","props","state","user","componentDidMount","getMap","componentWillUnmount","eles","document","getElementsByTagName","i","length","s","getAttribute","test","parentNode","removeChild","window","mapMarkerGps","undefined","getElementById","map","BMap","myGeo","Geocoder","domicileIcon","Symbol","BMap_Symbol_SHAPE_POINT","scale","fillColor","fillOpacity","schoolIcon","userIcon","addMarkerDomicile","getPoint","idCardLocation","point","centerAndZoom","addOverlay","Marker","icon","location","addMarkerSchool","lng","addMarkerUser","Point","center","circle","Circle","radius","lat","enableScrollWheelZoom","script","createElement","id","src","body","appendChild","render"],"mappings":"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","file":"Map.js","sourcesContent":["/**\r\n * Created by qwr on 2016/5/31.\r\n */\r\nimport React, {Component, PropTypes} from 'react'\r\nimport ReactDOM, {render, findDOMNode} from 'react-dom'\r\nexport default class Map extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            user:this.props.user\r\n        };\r\n    }\r\n    //客户端初次加载初始化\r\n    componentDidMount() {\r\n        this.getMap();\r\n    }\r\n    componentWillUnmount(){\r\n        var eles = document.getElementsByTagName(\"script\");\r\n        for (var i = eles.length-1; i>=0 ;i--){\r\n            var s = eles[i].getAttribute(\"src\");\r\n                if(s&&/http:\\/\\/api\\.map\\.baidu/.test(s)){\r\n                   // document.body.removeChild(eles[i]);\r\n                    eles[i].parentNode.removeChild(eles[i])\r\n                }\r\n        }\r\n        window.mapMarkerGps= undefined;\r\n    }\r\n    getMap() {\r\n         //api回调函数\r\n        var user=this.state.user;\r\n         window.mapMarkerGps=function () {\r\n              if(!document.getElementById('map')){\r\n                  return;\r\n              }\r\n             var map = new BMap.Map('map');\r\n             var myGeo = new BMap.Geocoder(),\r\n             domicileIcon = new BMap.Symbol(BMap_Symbol_SHAPE_POINT, {scale: 1.3, fillColor: 'green', fillOpacity: 0.8}), // 户籍地 {图标缩放大小 填充颜色 填充透明度}\r\n             schoolIcon = new BMap.Symbol(BMap_Symbol_SHAPE_POINT, {scale: 1.4, fillColor: 'red', fillOpacity: 0.8}), // 学校点\r\n             userIcon = new BMap.Symbol(BMap_Symbol_SHAPE_POINT, {scale: 1.5, fillColor: 'orange', fillOpacity: 0.8}); // 用户点\r\n             // 编写自定义函数, 创建标注 domicile GPS\r\n             function addMarkerDomicile () {\r\n                 myGeo.getPoint(user.idCardLocation, function (point) {\r\n                     if (point) {\r\n                         map.centerAndZoom(point, 12);\r\n                         map.addOverlay( new BMap.Marker(point, {icon: domicileIcon}) );\r\n                     }\r\n                     // 标注点 school\r\n                     if (user.location) addMarkerSchool();\r\n                     // 标注点 user\r\n                     if (user.lng != 0) addMarkerUser();\r\n                 }, '');\r\n             }\r\n             // 编写自定义函数, 创建标注 school GPS\r\n             function addMarkerSchool () {\r\n                 var point = new BMap.Point(user.location.center[0], user.location.center[1]);\r\n                 map.centerAndZoom(point, 12);\r\n                 map.addOverlay( new BMap.Marker(point, {icon: schoolIcon}) );\r\n                 // 覆盖物 圆\r\n                 var circle = new BMap.Circle(point, user.location.radius);\r\n                 map.addOverlay(circle);\r\n             }\r\n             // 编写自定义函数, 创建标注 user GPS\r\n             function addMarkerUser () {\r\n                 var point = new BMap.Point(user.lng, user.lat);\r\n                 map.centerAndZoom(point, 12);\r\n                 map.addOverlay( new BMap.Marker(point, {icon: userIcon}) );\r\n             }\r\n             //增加缩放功能\r\n             map.enableScrollWheelZoom(true);\r\n             if(user.idCardLocation || user.location || user.lng != 0){\r\n                 addMarkerDomicile();\r\n             }\r\n             else{\r\n                 map.centerAndZoom('中国', 4);\r\n             }\r\n         };\r\n        var script = document.getElementById(\"mapScript\");\r\n        if (!script) {\r\n            script = document.createElement('script');\r\n            script.id = \"mapScript\"\r\n            script.src = \"http://api.map.baidu.com/api?v=2.0&ak=KBwKAPPw9keZ0xQt7UfwuqC8&callback=mapMarkerGps\";\r\n            document.body.appendChild(script);\r\n        }\r\n    }\r\n    render(){\r\n        return(\r\n            null\r\n        )\r\n    }\r\n}\r\n"]}