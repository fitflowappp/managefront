{"version":3,"sources":["../../../src/components/modal/AccountModal.js"],"names":["AccountModal","props","state","show","account","name","role","headerImg","intro","password","componentWillReceiveProps","nextProps","editAccount","setState","_handleValidSubmit","e","preventDefault","postAccount","putAccount","query","that","id","res","code","info","msg","closeModal","uploadFile","target","after","set","getAttribute","value","openModal","render","bind","contentUri","mapDispatchToProps","dispatch","withRef"],"mappings":"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","file":"AccountModal.js","sourcesContent":["/**\r\n * Created by qwr on 2017/6/13.\r\n */\r\nimport React, {Component, PropTypes} from 'react'\r\nimport {connect} from 'react-redux'\r\nimport {bindActionCreators} from 'redux'\r\nimport {Button, Modal, Form, FormControl, FormGroup, ControlLabel, Col} from \"react-bootstrap\"\r\nimport {accountActions} from '../../actions'\r\nimport Alert from '../Alert'\r\nimport {upload} from \"../../common/fetch\";\r\nclass AccountModal extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state =\r\n            {\r\n                show: false,\r\n                account: {\r\n                    name: '',\r\n                    role: '',\r\n                    headerImg: null,\r\n                    intro: '',\r\n                    password: '',\r\n                }\r\n            }\r\n    }\r\n    componentWillReceiveProps(nextProps) {\r\n        const {editAccount,role}= nextProps;\r\n        if (editAccount) {\r\n             this.setState({\r\n             account: editAccount,\r\n             })\r\n        } else {\r\n            this.setState({\r\n                account: {\r\n                    name: '',\r\n                    role: role,\r\n                    headerImg: null,\r\n                    intro: '',\r\n                    password: '',\r\n                }\r\n            })\r\n        }\r\n    }\r\n\r\n    _handleValidSubmit(e) {\r\n        e.preventDefault();\r\n        const {postAccount, putAccount, query} = this.props;\r\n        const account = this.state.account;\r\n        const that = this;\r\n        if (account.id) {\r\n            putAccount(account, function (res) {\r\n                if(res.code==1){\r\n                    query();\r\n                }else{\r\n                    Alert.info({info:res.msg})\r\n                }\r\n            });\r\n        } else {\r\n            postAccount(account, function (res) {\r\n                if(res.code==1){\r\n                    query();\r\n                }else{\r\n                    Alert.info({info:res.msg})\r\n                }\r\n            });\r\n        }\r\n        that.closeModal();\r\n    };\r\n\r\n    uploadFile(e) {\r\n        const target = e.target;\r\n        const name = target.name;\r\n        const that = this;\r\n        var account = this.state.account;\r\n        upload(e).after(function (res) {\r\n            account[name] = res[0];\r\n            that.setState({\r\n                account: that.state.account,\r\n            })\r\n        });\r\n    }\r\n\r\n    set(e) {\r\n        const name = e.target.getAttribute('name');\r\n        const value = e.target.value;\r\n        var account = this.state.account;\r\n        account[name] = value;\r\n        this.setState({\r\n            account: account,\r\n        });\r\n    }\r\n\r\n    openModal() {\r\n        this.setState({\r\n            show: true\r\n        })\r\n    }\r\n\r\n    closeModal() {\r\n        this.setState({\r\n            show: false,\r\n        })\r\n    }\r\n\r\n    render() {\r\n        const editAccount = this.props.editAccount;\r\n        const account = this.state.account;\r\n        return (\r\n            <div className=\"static-modal\">\r\n                <Modal show={this.state.show} backdrop={false}>\r\n                    <Form horizontal onSubmit={this._handleValidSubmit.bind(this)}>\r\n                        <Modal.Header>\r\n                            <Modal.Title>\r\n                                {editAccount ? '编辑管理账号' : '新建管理账号'}\r\n                                {account.role == 0 && '(管理员)'}\r\n                                {account.role == 1 && '(用户)'}\r\n                                {account.role == 2 && '(买手)'}\r\n                                {account.role == 3 && '(仓库管理员)'}\r\n                                {account.role == 4 && '(搭配师）'}\r\n                                {account.role == 5 && '(采购人)'}\r\n                                </Modal.Title>\r\n                        </Modal.Header>\r\n                        <Modal.Body>\r\n                            <FormGroup controlId=\"name\">\r\n                                <Col componentClass={ControlLabel} sm={2}>\r\n                                    用户名\r\n                                </Col>\r\n                                <Col sm={10}>\r\n                                    <FormControl type=\"text\" name=\"name\" value={account.name}\r\n                                                 onChange={this.set.bind(this)}/>\r\n                                </Col>\r\n                            </FormGroup>\r\n                            <FormGroup controlId=\"password\">\r\n                                <Col componentClass={ControlLabel} sm={2}>\r\n                                    密码\r\n                                </Col>\r\n                                <Col sm={10}>\r\n                                    <FormControl type=\"password\" name=\"password\" value={account.password}\r\n                                                 onChange={this.set.bind(this)}/>\r\n                                </Col>\r\n                            </FormGroup>\r\n                            <FormGroup controlId=\"intro\">\r\n                                <Col componentClass={ControlLabel} sm={2}>\r\n                                    简介\r\n                                </Col>\r\n                                <Col sm={10}>\r\n                                    <FormControl type=\"text\" name=\"intro\" value={account.intro}\r\n                                                 onChange={this.set.bind(this)}/>\r\n                                </Col>\r\n                            </FormGroup>\r\n                            <FormGroup controlId=\"headerImg\">\r\n                                <Col componentClass={ControlLabel} sm={2}>\r\n                                    头像\r\n                                </Col>\r\n                                <Col sm={10}>\r\n                                    <FormControl type=\"file\" name=\"headerImg\" onChange={this.uploadFile.bind(this)}/>\r\n                                    {account.headerImg &&\r\n                                    <img src={account.headerImg.contentUri} alt=\"头像\" width='50' className=\"m-t5\"/>}\r\n                                </Col>\r\n                            </FormGroup>\r\n                        </Modal.Body>\r\n                        <Modal.Footer>\r\n                            <Button bsStyle=\"primary\" type=\"submit\">确认</Button>\r\n                            <Button bsStyle=\"default\" onClick={this.closeModal.bind(this)}>取消</Button>\r\n                        </Modal.Footer>\r\n                    </Form>\r\n                </Modal>\r\n            </div>\r\n        )\r\n    }\r\n}\r\nfunction mapDispatchToProps(dispatch) {\r\n    return bindActionCreators(accountActions, dispatch)\r\n}\r\nexport default connect(null, mapDispatchToProps, null, {withRef: true})(AccountModal)"]}