{"version":3,"sources":["../../../src/components/draft/removeRangeFromContentState.js"],"names":["Immutable","require","removeRangeFromContentState","contentState","selectionState","isCollapsed","blockMap","getBlockMap","startKey","getStartKey","startOffset","getStartOffset","endKey","getEndKey","endOffset","getEndOffset","startBlock","get","endBlock","characterList","removeFromList","getCharacterList","slice","concat","modifiedStart","merge","text","getText","newBlocks","toSeq","skipUntil","_","k","takeUntil","Map","map","filter","block","selectionBefore","selectionAfter","anchorKey","anchorOffset","focusKey","focusOffset","isBackward","targetList","shift","count","pop","head","tail","toList","module","exports"],"mappings":"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","file":"removeRangeFromContentState.js","sourcesContent":["/**\n * Copyright (c) 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @providesModule removeRangeFromContentState\n * \n */\n\n'use strict';\n\nvar Immutable = require('immutable');\n\nfunction removeRangeFromContentState(contentState, selectionState) {\n  if (selectionState.isCollapsed()) {\n    return contentState;\n  }\n\n  var blockMap = contentState.getBlockMap();\n  var startKey = selectionState.getStartKey();\n  var startOffset = selectionState.getStartOffset();\n  var endKey = selectionState.getEndKey();\n  var endOffset = selectionState.getEndOffset();\n\n  var startBlock = blockMap.get(startKey);\n  var endBlock = blockMap.get(endKey);\n  var characterList;\n\n  if (startBlock === endBlock) {\n    characterList = removeFromList(startBlock.getCharacterList(), startOffset, endOffset);\n  } else {\n    characterList = startBlock.getCharacterList().slice(0, startOffset).concat(endBlock.getCharacterList().slice(endOffset));\n  }\n\n  var modifiedStart = startBlock.merge({\n    text: startBlock.getText().slice(0, startOffset) + endBlock.getText().slice(endOffset),\n    characterList: characterList\n  });\n\n  var newBlocks = blockMap.toSeq().skipUntil(function (_, k) {\n    return k === startKey;\n  }).takeUntil(function (_, k) {\n    return k === endKey;\n  }).concat(Immutable.Map([[endKey, null]])).map(function (_, k) {\n    return k === startKey ? modifiedStart : null;\n  });\n\n  blockMap = blockMap.merge(newBlocks).filter(function (block) {\n    return !!block;\n  });\n\n  return contentState.merge({\n    blockMap: blockMap,\n    selectionBefore: selectionState,\n    selectionAfter: selectionState.merge({\n      anchorKey: startKey,\n      anchorOffset: startOffset,\n      focusKey: startKey,\n      focusOffset: startOffset,\n      isBackward: false\n    })\n  });\n}\n\n/**\n * Maintain persistence for target list when removing characters on the\n * head and tail of the character list.\n */\nfunction removeFromList(targetList, startOffset, endOffset) {\n  if (startOffset === 0) {\n    while (startOffset < endOffset) {\n      targetList = targetList.shift();\n      startOffset++;\n    }\n  } else if (endOffset === targetList.count()) {\n    while (endOffset > startOffset) {\n      targetList = targetList.pop();\n      endOffset--;\n    }\n  } else {\n    var head = targetList.slice(0, startOffset);\n    var tail = targetList.slice(endOffset);\n    targetList = head.concat(tail).toList();\n  }\n  return targetList;\n}\n\nmodule.exports = removeRangeFromContentState;"]}