{"version":3,"sources":["../../../src/components/draft/CharacterMetadata.js"],"names":["_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_get","get","_x","_x2","_x3","_again","_function","object","property","receiver","Function","desc","undefined","parent","value","getter","call","_classCallCheck","instance","TypeError","_inherits","subClass","superClass","constructor","__proto__","_require","require","Map","OrderedSet","Record","EMPTY_SET","defaultRecord","style","entity","CharacterMetadataRecord","CharacterMetadata","_CharacterMetadataRecord","apply","arguments","getStyle","getEntity","hasStyle","has","applyStyle","record","withStyle","set","add","create","removeStyle","withoutStyle","remove","applyEntity","entityKey","withEntity","config","EMPTY","configMap","merge","existing","pool","newCharacter","module","exports"],"mappings":"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","file":"CharacterMetadata.js","sourcesContent":["/**\n * Copyright (c) 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @providesModule CharacterMetadata\n * @typechecks\n * \n */\n\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _require = require('immutable');\n\nvar Map = _require.Map;\nvar OrderedSet = _require.OrderedSet;\nvar Record = _require.Record;\n\nvar EMPTY_SET = OrderedSet();\n\nvar defaultRecord = {\n  style: EMPTY_SET,\n  entity: null\n};\n\nvar CharacterMetadataRecord = Record(defaultRecord);\n\nvar CharacterMetadata = (function (_CharacterMetadataRecord) {\n  _inherits(CharacterMetadata, _CharacterMetadataRecord);\n\n  function CharacterMetadata() {\n    _classCallCheck(this, CharacterMetadata);\n\n    _get(Object.getPrototypeOf(CharacterMetadata.prototype), 'constructor', this).apply(this, arguments);\n  }\n\n  _createClass(CharacterMetadata, [{\n    key: 'getStyle',\n    value: function getStyle() {\n      return this.get('style');\n    }\n  }, {\n    key: 'getEntity',\n    value: function getEntity() {\n      return this.get('entity');\n    }\n  }, {\n    key: 'hasStyle',\n    value: function hasStyle(style) {\n      return this.getStyle().has(style);\n    }\n  }], [{\n    key: 'applyStyle',\n    value: function applyStyle(record, style) {\n      var withStyle = record.set('style', record.getStyle().add(style));\n      return CharacterMetadata.create(withStyle);\n    }\n  }, {\n    key: 'removeStyle',\n    value: function removeStyle(record, style) {\n      var withoutStyle = record.set('style', record.getStyle().remove(style));\n      return CharacterMetadata.create(withoutStyle);\n    }\n  }, {\n    key: 'applyEntity',\n    value: function applyEntity(record, entityKey) {\n      var withEntity = record.getEntity() === entityKey ? record : record.set('entity', entityKey);\n      return CharacterMetadata.create(withEntity);\n    }\n\n    /**\n     * Use this function instead of the `CharacterMetadata` constructor.\n     * Since most content generally uses only a very small number of\n     * style/entity permutations, we can reuse these objects as often as\n     * possible.\n     */\n  }, {\n    key: 'create',\n    value: function create(config) {\n      if (!config) {\n        return EMPTY;\n      }\n\n      // Fill in unspecified properties, if necessary.\n      var configMap = Map({ style: EMPTY_SET, entity: null }).merge(config);\n\n      var existing = pool.get(configMap);\n      if (existing) {\n        return existing;\n      }\n\n      var newCharacter = new CharacterMetadata(configMap);\n      pool = pool.set(configMap, newCharacter);\n      return newCharacter;\n    }\n  }]);\n\n  return CharacterMetadata;\n})(CharacterMetadataRecord);\n\nvar EMPTY = new CharacterMetadata();\nvar pool = Map([[Map(defaultRecord), EMPTY]]);\n\nCharacterMetadata.EMPTY = EMPTY;\n\nmodule.exports = CharacterMetadata;"]}