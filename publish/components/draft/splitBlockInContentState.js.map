{"version":3,"sources":["../../../src/components/draft/splitBlockInContentState.js"],"names":["generateRandomKey","require","invariant","splitBlockInContentState","contentState","selectionState","isCollapsed","process","env","NODE_ENV","undefined","key","getAnchorKey","offset","getAnchorOffset","blockMap","getBlockMap","blockToSplit","get","text","getText","chars","getCharacterList","blockAbove","merge","slice","characterList","keyBelow","blockBelow","blocksBefore","toSeq","takeUntil","v","blocksAfter","skipUntil","rest","newBlocks","concat","getKey","toOrderedMap","selectionBefore","selectionAfter","anchorKey","anchorOffset","focusKey","focusOffset","isBackward","module","exports"],"mappings":"AAAA;;;;;;;;;;;;;AAaA;;AAEA,IAAIA,oBAAoBC,QAAQ,qBAAR,CAAxB;AACA,IAAIC,YAAYD,QAAQ,oBAAR,CAAhB;;AAEA,SAASE,wBAAT,CAAkCC,YAAlC,EAAgDC,cAAhD,EAAgE;AAC9D,GAACA,eAAeC,WAAf,EAAD,GAAgCC,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwCP,UAAU,KAAV,EAAiB,oCAAjB,CAAxC,GAAiGA,UAAU,KAAV,CAAjI,GAAoJQ,SAApJ;;AAEA,MAAIC,MAAMN,eAAeO,YAAf,EAAV;AACA,MAAIC,SAASR,eAAeS,eAAf,EAAb;AACA,MAAIC,WAAWX,aAAaY,WAAb,EAAf;AACA,MAAIC,eAAeF,SAASG,GAAT,CAAaP,GAAb,CAAnB;;AAEA,MAAIQ,OAAOF,aAAaG,OAAb,EAAX;AACA,MAAIC,QAAQJ,aAAaK,gBAAb,EAAZ;;AAEA,MAAIC,aAAaN,aAAaO,KAAb,CAAmB;AAClCL,UAAMA,KAAKM,KAAL,CAAW,CAAX,EAAcZ,MAAd,CAD4B;AAElCa,mBAAeL,MAAMI,KAAN,CAAY,CAAZ,EAAeZ,MAAf;AAFmB,GAAnB,CAAjB;;AAKA,MAAIc,WAAW3B,mBAAf;AACA,MAAI4B,aAAaL,WAAWC,KAAX,CAAiB;AAChCb,SAAKgB,QAD2B;AAEhCR,UAAMA,KAAKM,KAAL,CAAWZ,MAAX,CAF0B;AAGhCa,mBAAeL,MAAMI,KAAN,CAAYZ,MAAZ;AAHiB,GAAjB,CAAjB;;AAMA,MAAIgB,eAAed,SAASe,KAAT,GAAiBC,SAAjB,CAA2B,UAAUC,CAAV,EAAa;AACzD,WAAOA,MAAMf,YAAb;AACD,GAFkB,CAAnB;AAGA,MAAIgB,cAAclB,SAASe,KAAT,GAAiBI,SAAjB,CAA2B,UAAUF,CAAV,EAAa;AACxD,WAAOA,MAAMf,YAAb;AACD,GAFiB,EAEfkB,IAFe,EAAlB;AAGA,MAAIC,YAAYP,aAAaQ,MAAb,CAAoB,CAAC,CAACd,WAAWe,MAAX,EAAD,EAAsBf,UAAtB,CAAD,EAAoC,CAACK,WAAWU,MAAX,EAAD,EAAsBV,UAAtB,CAApC,CAApB,EAA4FK,WAA5F,EAAyGM,YAAzG,EAAhB;;AAEA,SAAOnC,aAAaoB,KAAb,CAAmB;AACxBT,cAAUqB,SADc;AAExBI,qBAAiBnC,cAFO;AAGxBoC,oBAAgBpC,eAAemB,KAAf,CAAqB;AACnCkB,iBAAWf,QADwB;AAEnCgB,oBAAc,CAFqB;AAGnCC,gBAAUjB,QAHyB;AAInCkB,mBAAa,CAJsB;AAKnCC,kBAAY;AALuB,KAArB;AAHQ,GAAnB,CAAP;AAWD;;AAEDC,OAAOC,OAAP,GAAiB7C,wBAAjB","file":"splitBlockInContentState.js","sourcesContent":["/**\n * Copyright (c) 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @providesModule splitBlockInContentState\n * @typechecks\n * \n */\n\n'use strict';\n\nvar generateRandomKey = require('./generateRandomKey');\nvar invariant = require('fbjs/lib/invariant');\n\nfunction splitBlockInContentState(contentState, selectionState) {\n  !selectionState.isCollapsed() ? process.env.NODE_ENV !== 'production' ? invariant(false, 'Selection range must be collapsed.') : invariant(false) : undefined;\n\n  var key = selectionState.getAnchorKey();\n  var offset = selectionState.getAnchorOffset();\n  var blockMap = contentState.getBlockMap();\n  var blockToSplit = blockMap.get(key);\n\n  var text = blockToSplit.getText();\n  var chars = blockToSplit.getCharacterList();\n\n  var blockAbove = blockToSplit.merge({\n    text: text.slice(0, offset),\n    characterList: chars.slice(0, offset)\n  });\n\n  var keyBelow = generateRandomKey();\n  var blockBelow = blockAbove.merge({\n    key: keyBelow,\n    text: text.slice(offset),\n    characterList: chars.slice(offset)\n  });\n\n  var blocksBefore = blockMap.toSeq().takeUntil(function (v) {\n    return v === blockToSplit;\n  });\n  var blocksAfter = blockMap.toSeq().skipUntil(function (v) {\n    return v === blockToSplit;\n  }).rest();\n  var newBlocks = blocksBefore.concat([[blockAbove.getKey(), blockAbove], [blockBelow.getKey(), blockBelow]], blocksAfter).toOrderedMap();\n\n  return contentState.merge({\n    blockMap: newBlocks,\n    selectionBefore: selectionState,\n    selectionAfter: selectionState.merge({\n      anchorKey: keyBelow,\n      anchorOffset: 0,\n      focusKey: keyBelow,\n      focusOffset: 0,\n      isBackward: false\n    })\n  });\n}\n\nmodule.exports = splitBlockInContentState;"]}