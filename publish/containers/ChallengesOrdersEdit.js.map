{"version":3,"sources":["../../src/containers/ChallengesOrdersEdit.js"],"names":["ChallengesOrderEdit","props","state","challengeOrder","challenges","success","componentDidMount","id","routeParams","getChallengeOrders","that","res","content","setState","componentDidUpdate","prevProps","prevState","save","event","preventDefault","putChallengeOrders","result","code","info","msg","pushChallenges","obj","unlocked","push","upChallenge","index","before","after","delChallenge","confirm","title","body","surecb","splice","openChallengesListModal","refs","getWrappedInstance","openModal","set","e","name","target","getAttribute","value","back","router","goBack","render","bind","map","challenge","fontSize","mapStateToProps","challengeorders","mapDispatchToProps","dispatch"],"mappings":";;;;;;;;;;;;;;;;;;AAGA;;;;AACA;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;;;IACMA,mB;;;AACF,iCAAYC,KAAZ,EAAmB;AAAA;;AAAA,mEACf,sBAAMA,KAAN,CADe;;AAEf,cAAKC,KAAL,GAAa;AACTC,4BAAe;AACXC,4BAAW;AADA,aADN;AAITC,qBAAQ;AAJC,SAAb;AAFe;AAQlB;;kCACDC,iB,gCAAoB;AAChB,YAAIC,KAAG,KAAKN,KAAL,CAAWO,WAAX,CAAuBD,EAA9B;AACA,YAAGA,MAAI,CAAP,EAAS;AAAA,gBACEE,kBADF,GACwB,KAAKR,KAD7B,CACEQ,kBADF;;AAEL,gBAAMC,OAAK,IAAX;AACAD,+BAAmB,EAACF,IAAGA,EAAJ,EAAnB,EAA2B,UAAUI,GAAV,EAAe;AACtC,oBAAG,CAACA,IAAIC,OAAJ,CAAYR,UAAhB,EAA2B;AACvBO,wBAAIC,OAAJ,CAAYR,UAAZ,GAAuB,EAAvB;AACH;AACDM,qBAAKG,QAAL,CAAc;AACVV,oCAAeQ,IAAIC;AADT,iBAAd;AAGH,aAPD;AAQH;AACJ,K;;kCACDE,kB,+BAAmBC,S,EAAWC,S,EAAW,CAExC,C;;kCACDC,I,iBAAKC,K,EAAM;AACPA,cAAMC,cAAN;AADO,YAEAC,kBAFA,GAEsB,KAAKnB,KAF3B,CAEAmB,kBAFA;;AAGP,YAAIV,OAAK,IAAT;AACAU,2BAAmB,KAAKlB,KAAL,CAAWC,cAA9B,EAA6C,UAAUQ,GAAV,EAAe;AACxD,gBAAGA,IAAIU,MAAJ,CAAWC,IAAX,IAAiB,CAApB,EAAsB;AAClBZ,qBAAKG,QAAL,CAAc;AACVR,6BAAQ;AADE,iBAAd;AAGH;AACD,4BAAMkB,IAAN,CAAW,EAACA,MAAKZ,IAAIU,MAAJ,CAAWG,GAAjB,EAAX;AACH,SAPD;AAQH,K;;kCACDC,c,2BAAeC,G,EAAI;AACfA,YAAIC,QAAJ,GAAa,KAAb;AACA,YAAIxB,iBAAiB,KAAKD,KAAL,CAAWC,cAAhC;AACAA,uBAAeC,UAAf,CAA0BwB,IAA1B,CAA+BF,GAA/B;AACA,aAAKb,QAAL,CAAcV,cAAd;AACH,K;;kCACD0B,W,wBAAYC,K,EAAM;AACd,YAAI3B,iBAAiB,KAAKD,KAAL,CAAWC,cAAhC;AACA,YAAIC,aAAWD,eAAeC,UAA9B;AACA,YAAG0B,SAAO,CAAV,EAAY;AACR,gBAAIC,SAAO3B,WAAW0B,QAAM,CAAjB,CAAX;AACA,gBAAIE,QAAM5B,WAAW0B,KAAX,CAAV;AACA1B,uBAAW0B,QAAM,CAAjB,IAAoBE,KAApB;AACA5B,uBAAW0B,KAAX,IAAkBC,MAAlB;AACA,iBAAKlB,QAAL,CAAcV,cAAd;AACH;AACJ,K;;kCACD8B,Y,yBAAaH,K,EAAO;AAChB,YAAIpB,OAAK,IAAT;AACA,wBAAMwB,OAAN,CAAc;AACVC,mBAAO,QADG,EACOC,MAAM,UADb,EACyBC,QAAQ,kBAAY;AACnD,oBAAIlC,iBAAiBO,KAAKR,KAAL,CAAWC,cAAhC;AACAA,+BAAeC,UAAf,CAA0BkC,MAA1B,CAAiCR,KAAjC,EAAwC,CAAxC;AACApB,qBAAKG,QAAL,CAAcV,cAAd;AACH;AALS,SAAd;AAOH,K;;kCACDoC,uB,sCAAyB;AACrB,aAAKC,IAAL,CAAU,qBAAV,EAAiCC,kBAAjC,GAAsDC,SAAtD;AACH,K;;kCACDC,G,gBAAIb,K,EAAMc,C,EAAE;AACR,YAAIC,OAAMD,EAAEE,MAAF,CAASC,YAAT,CAAsB,MAAtB,CAAV;AACA,YAAI5C,iBAAiB,KAAKD,KAAL,CAAWC,cAAhC;AACA,YAAK6C,QAAM,CAAC7C,eAAeC,UAAf,CAA0B0B,KAA1B,EAAiCH,QAA7C;AACAxB,uBAAeC,UAAf,CAA0B0B,KAA1B,EAAiCe,IAAjC,IAAuCG,KAAvC;AACA,aAAKnC,QAAL,CAAcV,cAAd;AACH,K;;kCACD8C,I,mBAAM;AACF,aAAKhD,KAAL,CAAWiD,MAAX,CAAkBC,MAAlB;AACH,K;;kCACDC,M,qBAAS;AAAA;;AACL,YAAMhD,aAAa,KAAKF,KAAL,CAAWC,cAAX,CAA0BC,UAA7C;AACA,YAAIC,UAAQ,KAAKH,KAAL,CAAWG,OAAvB;AACA,eACI;AAAA;AAAA;AACI,mEAAQ,OAAM,wBAAd,GADJ;AAEI,2EAAqB,KAAI,qBAAzB,EAA+C,gBAAgB,KAAKoB,cAAL,CAAoB4B,IAApB,CAAyB,IAAzB,CAA/D,GAFJ;AAGKhD,uBAAS;AAAA;AAAA,kBAAK,WAAU,qCAAf;AAAA;AAAA,aAHd;AAII;AAAA;AAAA,kBAAK,WAAU,KAAf;AACI;AAAA;AAAA,sBAAK,WAAU,YAAf;AACI;AAAA;AAAA,0BAAI,WAAU,WAAd;AAAA;AAAA;AADJ,iBADJ;AAII;AAAA;AAAA,sBAAM,MAAK,MAAX,EAAmB,UAAY,KAAKY,IAAL,CAAUoC,IAAV,CAAe,IAAf,CAA/B;AACI;AAAA;AAAA,0BAAK,WAAU,UAAf;AACKjD,sCAAYA,WAAWkD,GAAX,CAAe,UAACC,SAAD,EAAYzB,KAAZ;AAAA,mCACxB;AAAA;AAAA,kCAAK,KAAKA,KAAV,EAAiB,WAAU,MAA3B;AACI,qEAAG,SAAS,OAAKD,WAAL,CAAiBwB,IAAjB,SAA2BvB,KAA3B,CAAZ,EAA+C,WAAU,2CAAzD,EAAqG,OAAO,EAAC0B,UAAS,MAAV,EAA5G,GADJ;AAEI;AAAA;AAAA,sCAAM,WAAU,MAAhB;AAAA;AAAA,iCAFJ;AAE4CD,0CAAUjC,IAFtD;AAAA;AAE6DiC,0CAAUpB,KAFvE;AAGI,qEAAG,SAAS,OAAKF,YAAL,CAAkBoB,IAAlB,SAA4BvB,KAA5B,CAAZ,EAAgD,WAAU,6CAA1D,EAAwG,OAAO,EAAC0B,UAAS,MAAV,EAA/G,GAHJ;AAII,yEAAO,MAAK,UAAZ,EAAuB,MAAK,UAA5B,EAAuC,SAASD,UAAU5B,QAA1D,EAAoE,UAAU,OAAKgB,GAAL,CAASU,IAAT,SAAmBvB,KAAnB,CAA9E,GAJJ;AAAA;AAAA,6BADwB;AAAA,yBAAf,CADjB;AASI,6DAAG,SAAS,KAAKS,uBAAL,CAA6Bc,IAA7B,CAAkC,IAAlC,CAAZ,EAAqD,WAAU,wCAA/D,EAAwG,OAAO,EAACG,UAAS,MAAV,EAA/G;AATJ,qBADJ;AAYI;AAAA;AAAA,0BAAK,WAAU,qBAAf;AACI;AAAA;AAAA;AACI;AAAA;AAAA,kCAAK,IAAI,EAAT,EAAa,WAAU,iBAAvB;AACI;AAAA;AAAA,sCAAQ,MAAK,QAAb,EAAuB,WAAU,kBAAjC;AAAA;AAAA,iCADJ;AAEI;AAAA;AAAA,sCAAQ,MAAK,QAAb,EAAsB,WAAU,uBAAhC,EAAwD,SAAS,KAAKP,IAAL,CAAUI,IAAV,CAAe,IAAf,CAAjE;AAAA;AAAA;AAFJ;AADJ;AADJ;AAZJ;AAJJ;AAJJ,SADJ;AAkCH,K;;;qBAlIL;;;;;AAoIA,SAASI,eAAT,CAAyBvD,KAAzB,EAAgC;AAC5B,WAAO;AACHwD,yBAAiBxD,MAAMwD;AADpB,KAAP;AAGH;AACD;AACA,SAASC,kBAAT,CAA4BC,QAA5B,EAAsC;AAClC,WAAO,gEAA2CA,QAA3C,CAAP;AACH;;AAED;kBACe,yBAAQH,eAAR,EAAyBE,kBAAzB,EAA6C,6BAAW3D,mBAAX,CAA7C,C","file":"ChallengesOrdersEdit.js","sourcesContent":["/**\r\n * Created by qwr on 2017/9/18.\r\n */\r\nimport React, {Component, PropTypes} from 'react'\r\nimport Helmet from \"react-helmet\"\r\nimport {bindActionCreators} from 'redux'\r\nimport {connect} from 'react-redux'\r\nimport {Link, withRouter} from \"react-router\";\r\nimport {Col, Form, Pagination, Row} from \"react-bootstrap\"\r\nimport {challengeordersActions} from '../actions'\r\nimport Alert from '../components/Alert';\r\nimport ChallengesListModal from '../components/modal/ChallengesListModal';\r\nclass ChallengesOrderEdit extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            challengeOrder:{\r\n                challenges:[],\r\n            },\r\n            success:false,\r\n        };\r\n    }\r\n    componentDidMount() {\r\n        var id=this.props.routeParams.id;\r\n        if(id!=0){\r\n            const {getChallengeOrders} = this.props;\r\n            const that=this;\r\n            getChallengeOrders({id:id},function (res) {\r\n                if(!res.content.challenges){\r\n                    res.content.challenges=[];\r\n                }\r\n                that.setState({\r\n                    challengeOrder:res.content,\r\n                })\r\n            })\r\n        }\r\n    }\r\n    componentDidUpdate(prevProps, prevState) {\r\n\r\n    }\r\n    save(event){\r\n        event.preventDefault();\r\n        const {putChallengeOrders} = this.props;\r\n        var that=this;\r\n        putChallengeOrders(this.state.challengeOrder,function (res) {\r\n            if(res.result.code==1){\r\n                that.setState({\r\n                    success:true,\r\n                })\r\n            }\r\n            Alert.info({info:res.result.msg});\r\n        });\r\n    }\r\n    pushChallenges(obj){\r\n        obj.unlocked=false;\r\n        var challengeOrder = this.state.challengeOrder;\r\n        challengeOrder.challenges.push(obj);\r\n        this.setState(challengeOrder);\r\n    }\r\n    upChallenge(index){\r\n        var challengeOrder = this.state.challengeOrder;\r\n        var challenges=challengeOrder.challenges;\r\n        if(index!=0){\r\n            var before=challenges[index-1];\r\n            var after=challenges[index];\r\n            challenges[index-1]=after;\r\n            challenges[index]=before;\r\n            this.setState(challengeOrder);\r\n        }\r\n    }\r\n    delChallenge(index) {\r\n        var that=this;\r\n        Alert.confirm({\r\n            title: 'delete', body: \"confirm？\", surecb: function () {\r\n                var challengeOrder = that.state.challengeOrder;\r\n                challengeOrder.challenges.splice(index, 1);\r\n                that.setState(challengeOrder);\r\n            }\r\n        });\r\n    }\r\n    openChallengesListModal(){\r\n        this.refs['ChallengesListModal'].getWrappedInstance().openModal();\r\n    }\r\n    set(index,e){\r\n        var name =e.target.getAttribute('name');\r\n        var challengeOrder = this.state.challengeOrder;\r\n        var  value=!challengeOrder.challenges[index].unlocked;\r\n        challengeOrder.challenges[index][name]=value;\r\n        this.setState(challengeOrder);\r\n    }\r\n    back(){\r\n        this.props.router.goBack();\r\n    }\r\n    render() {\r\n        const challenges = this.state.challengeOrder.challenges;\r\n        var success=this.state.success;\r\n        return (\r\n            <div>\r\n                <Helmet title=\"Manage Challenge Order\"/>\r\n                <ChallengesListModal ref=\"ChallengesListModal\" pushChallenges={this.pushChallenges.bind(this)}/>\r\n                {success&&<div className=\"callout callout-success text-center\">Your changes have been succesfully saved</div>}\r\n                <div className=\"box\">\r\n                    <div className=\"box-header\">\r\n                        <h3 className=\"box-title\">Manage Challenge Order</h3>\r\n                    </div>\r\n                    <Form role=\"form\"  onSubmit = {this.save.bind(this)}>\r\n                        <div className=\"box-body\">\r\n                            {challenges&&challenges.map((challenge, index) =>\r\n                                <div key={index} className=\"m-b5\">\r\n                                    <i onClick={this.upChallenge.bind(this,index)} className=\"fa fa-arrow-up text-primary pointer m-r10\" style={{fontSize:'20px'}}></i>\r\n                                    <text className=\"m-r5\">Challenge</text>{challenge.code}:{challenge.title}\r\n                                    <i onClick={this.delChallenge.bind(this,index)} className=\"fa fa-close text-danger pointer m-l10 m-r10\" style={{fontSize:'20px'}}></i>\r\n                                    <input type=\"checkbox\" name=\"unlocked\" checked={challenge.unlocked} onChange={this.set.bind(this,index)}/>unlocked?\r\n                                </div>\r\n                            )}\r\n                            <i onClick={this.openChallengesListModal.bind(this)} className=\"fa fa-plus-square text-primary pointer\" style={{fontSize:'40px'}}></i>\r\n                        </div>\r\n                        <div className=\"box-footer clearfix\">\r\n                            <Row>\r\n                                <Col lg={12} className=\"col-md-offset-3\">\r\n                                    <button type=\"submit\"  className=\"btn  btn-primary\" >Save</button>\r\n                                    <button type=\"button\" className=\"btn btn-default m-l10\" onClick={this.back.bind(this)}>Back</button>\r\n                                </Col>\r\n                            </Row>\r\n                        </div>\r\n                    </Form>\r\n                </div>\r\n\r\n            </div>\r\n        )\r\n    }\r\n}\r\nfunction mapStateToProps(state) {\r\n    return {\r\n        challengeorders: state.challengeorders\r\n    }\r\n}\r\n//将action的所有方法绑定到props上\r\nfunction mapDispatchToProps(dispatch) {\r\n    return bindActionCreators(challengeordersActions, dispatch)\r\n}\r\n\r\n//通过react-redux提供的connect方法将我们需要的state中的数据和actions中的方法绑定到props上\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(ChallengesOrderEdit))\r\n"]}