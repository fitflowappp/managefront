{"version":3,"sources":["../../src/containers/Users.js"],"names":["Users","props","state","condition","number","size","componentDidMount","location","query","setState","queryUsers","setCondition","eventKey","router","replace","pathname","super","user","putSuper","deleteSuper","that","role","uid","id","res","csv","window","href","render","users","list","bind","content","map","index","facebookUid","email","crDate","unRegistered","facebookRegistrationSumbmittedDate","registerDate","userState","currentChallengeId","completedChallengeNum","duration","completedWorkoutNum","userConfiguration","notification","remider","shareCount","totalPages","parseInt","mapStateToProps","mapDispatchToProps","dispatch"],"mappings":"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","file":"Users.js","sourcesContent":["/**\r\n * Created by qwr on 2017/10/11.\r\n */\r\nimport React, {Component, PropTypes} from 'react'\r\nimport Helmet from \"react-helmet\"\r\nimport {bindActionCreators} from 'redux'\r\nimport {connect} from 'react-redux'\r\nimport {Link, withRouter} from \"react-router\";\r\nimport {Col, Pagination} from \"react-bootstrap\"\r\nimport {upload} from '../common/fetch'\r\nimport {getTime} from '../common'\r\nimport {usersActions} from '../actions'\r\nimport Alert from '../components/Alert';\r\nclass Users extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            condition: {\r\n                number:0,\r\n                size:20,\r\n            },\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        var condition = this.props.location.query;\r\n        if (!condition.number) {\r\n            condition = this.state.condition;\r\n        } else {\r\n            this.setState({\r\n                condition: condition,\r\n            })\r\n        }\r\n        this.query(condition);\r\n    }\r\n\r\n    query(condition) {\r\n        const {queryUsers} = this.props;\r\n        queryUsers(condition);\r\n    }\r\n\r\n    setCondition(eventKey) {\r\n        var condition = this.state.condition;\r\n        condition.number = eventKey-1;\r\n        this.setState(condition);\r\n        this.query(condition);\r\n        this.props.router.replace({pathname: this.props.location.pathname, query: condition});\r\n    }\r\n    super(user){\r\n        const {putSuper,deleteSuper}=this.props;\r\n        const that=this;\r\n        const condition = that.state.condition;\r\n        if(user.role==0){\r\n            deleteSuper({uid:user.id},function (res) {\r\n                that.query(condition)\r\n            })\r\n        }else{\r\n            putSuper({uid:user.id},function (res) {\r\n                that.query(condition)\r\n            })\r\n        }\r\n    }\r\n    csv(){\r\n        window.location.href='/api/manage/admin/csv';\r\n    }\r\n    render() {\r\n        const users = this.props.users.list;\r\n        const condition=this.state.condition;\r\n        return (\r\n            <div>\r\n                <Helmet title=\"Users\"/>\r\n                {users&&<div className=\"box\">\r\n                    <div className=\"box-header\">\r\n                        <h3 className=\"box-title\">Users</h3>\r\n                        <div className=\"box-tools\">\r\n                            <button type=\"button\" className=\"btn btn-success pull-right m-5\" onClick={this.csv.bind(this)}>\r\n                                <i className=\"fa fa-download\"></i>Export csv\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"box-body table-responsive\">\r\n                        <table className=\"table table-bordered table-hover\">\r\n                            <tbody>\r\n                            <tr>\r\n                                <th>ID</th>\r\n                                <th>Facebook ID</th>\r\n                                <th>Email Address</th>\r\n                                <th>Timestamp of App First Opened</th>\r\n                                <th>Registered?</th>\r\n                                <th>Timestamp of Facebook Registration submitted</th>\r\n                                <th>Timestamp of Registration Completed</th>\r\n                                <th>Current challenge ID</th>\r\n                                <th>Number of completed challenges</th>\r\n                                <th>Cumulative duration of videos watched</th>\r\n                                <th>Number of completed Workouts</th>\r\n                                <th>Scheduling in-app notification on?</th>\r\n                                <th>Scheduling calendar reminder on?</th>\r\n                                <th>Cumulative number of social shares</th>\r\n                                <th></th>\r\n                            </tr>\r\n                             {users.content.map((user, index) =>\r\n                             <tr key={index}>\r\n                             <td><Link to={\"/yusers/userdetails/\"+user.user.id}>{user.user.id}</Link></td>\r\n                             <td>{user.facebookUid}</td>\r\n                             <td>{user.email}</td>\r\n                             <td>{getTime(user.user.crDate)}</td>\r\n                             <td>{user.user.unRegistered?'no':'yes'}</td>\r\n                             <td>{getTime(user.user.facebookRegistrationSumbmittedDate)}</td>\r\n                             <td>{getTime(user.user.registerDate)}</td>\r\n                             <td>{user.userState&&user.userState.currentChallengeId}</td>\r\n                             <td>{user.userState&&user.userState.completedChallengeNum}</td>\r\n                             <td>{user.userState&&user.userState.duration}</td>\r\n                             <td>{user.userState&&user.userState.completedWorkoutNum}</td>\r\n                             <td>{user.userConfiguration&&user.userConfiguration.notification?'yes':'no'}</td>\r\n                             <td>{user.userConfiguration&&user.userConfiguration.remider?'yes':'no'}</td>\r\n                             <td>{user.shareCount}</td>\r\n                             <td>\r\n                                 {user.user&&user.user.role==0&&<button type=\"button\" className=\"btn btn-danger m-5\" onClick={this.super.bind(this,user.user)}>cancelSuper</button>}\r\n                                 {user.user&&user.user.role!=0&&<button type=\"button\" className=\"btn btn-success m-5\" onClick={this.super.bind(this,user.user)}>setSuper</button>}\r\n                             </td>\r\n                             </tr>\r\n                             )}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n\r\n                    <div className=\"box-footer clearfix\">\r\n                        <div className=\"pull-right\">\r\n                            <Pagination\r\n                                prev\r\n                                next\r\n                                first\r\n                                last\r\n                                ellipsis\r\n                                boundaryLinks\r\n                                items={users.totalPages}\r\n                                maxButtons={2}\r\n                                activePage={parseInt(condition.number)+1}\r\n                                onSelect={this.setCondition.bind(this)}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>}\r\n\r\n            </div>\r\n        )\r\n    }\r\n}\r\nfunction mapStateToProps(state) {\r\n    return {\r\n        users: state.users\r\n    }\r\n}\r\n//将action的所有方法绑定到props上\r\nfunction mapDispatchToProps(dispatch) {\r\n    return bindActionCreators(usersActions, dispatch)\r\n}\r\n\r\n//通过react-redux提供的connect方法将我们需要的state中的数据和actions中的方法绑定到props上\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(Users))"]}