{"version":3,"sources":["../../src/containers/Challenges.js"],"names":["Challenges","props","state","condition","sortKey","sortType","componentDidMount","location","query","setState","componentDidUpdate","prevProps","prevState","queryChallenges","setCondition","router","replace","pathname","csv","window","href","render","challenges","list","bind","map","challenge","index","id","code","title","startedTimes","completedTimes","startedUserCount","completedUserCount","mapStateToProps","mapDispatchToProps","dispatch"],"mappings":";;;;;;;;;;;;;;;;;;AAGA;;;;AACA;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;AAVA;;;IAWMA,U;;;AACF,wBAAYC,KAAZ,EAAmB;AAAA;;AAAA,mEACf,sBAAMA,KAAN,CADe;;AAEf,cAAKC,KAAL,GAAa;AACTC,uBAAU;AACNC,yBAAQ,IADF;AAENC,0BAAS,CAFH,CAEM;AAFN;AADD,SAAb;AAFe;AAQlB;;yBACDC,iB,gCAAoB;AAChB,YAAIH,YAAU,KAAKF,KAAL,CAAWM,QAAX,CAAoBC,KAAlC;AACA,YAAG,CAACL,UAAUC,OAAd,EAAsB;AAClBD,wBAAU,KAAKD,KAAL,CAAWC,SAArB;AACH,SAFD,MAEK;;AAED,iBAAKM,QAAL,CAAc;AACVN,2BAAUA;AADA,aAAd;AAGH;AACD,aAAKK,KAAL,CAAWL,SAAX;AACH,K;;yBACDO,kB,+BAAmBC,S,EAAWC,S,EAAW,CAExC,C;;yBACDJ,K,kBAAML,S,EAAW;AAAA,YACNU,eADM,GACa,KAAKZ,KADlB,CACNY,eADM;;AAEbA,wBAAgBV,SAAhB;AACH,K;;yBACDW,Y,yBAAaV,O,EAAQ;AACjB,YAAID,YAAU,KAAKD,KAAL,CAAWC,SAAzB;AACA,YAAIE,QAAJ;;AAEA,YAAGD,WAASD,UAAUC,OAAtB,EAA8B;AAC1B,gBAAGD,UAAUE,QAAV,IAAoB,CAAvB,EAAyB;AACrBA,2BAAS,CAAC,CAAV;AACH,aAFD,MAEK;AACDA,2BAAS,CAAT;AACH;AACJ,SAND,MAMK;AACDA,uBAAS,CAAT;AACH;;AAEDF,kBAAUC,OAAV,GAAkBA,OAAlB;AACAD,kBAAUE,QAAV,GAAmBA,QAAnB;;AAEA,aAAKI,QAAL,CAAcN,SAAd;AACA,aAAKK,KAAL,CAAWL,SAAX;AACA,aAAKF,KAAL,CAAWc,MAAX,CAAkBC,OAAlB,CAA0B,EAACC,UAAU,KAAKhB,KAAL,CAAWM,QAAX,CAAoBU,QAA/B,EAAyCT,OAAOL,SAAhD,EAA1B;AACH,K;;yBACDe,G,kBAAK;AACDC,eAAOZ,QAAP,CAAgBa,IAAhB,GAAqB,gCAArB;AACH,K;;yBACDC,M,qBAAS;AACL,YAAMC,aAAa,KAAKrB,KAAL,CAAWqB,UAAX,CAAsBC,IAAtB,IAA4B,EAA/C;AACA,YAAIpB,YAAU,KAAKD,KAAL,CAAWC,SAAzB;AACA,eACI;AAAA;AAAA;AACI,mEAAQ,OAAM,YAAd,GADJ;AAEI;AAAA;AAAA,kBAAK,WAAU,KAAf;AACI;AAAA;AAAA,sBAAK,WAAU,YAAf;AACI;AAAA;AAAA,0BAAI,WAAU,WAAd;AAAA;AAAA,qBADJ;AAEI;AAAA;AAAA,0BAAK,WAAU,WAAf;AACI;AAAA;AAAA,8BAAM,IAAI,mBAAV;AACI;AAAA;AAAA,kCAAQ,MAAK,QAAb,EAAuB,WAAU,sBAAjC;AAAA;AAAA;AADJ,yBADJ;AAII;AAAA;AAAA,8BAAM,IAAI,mBAAV;AACI;AAAA;AAAA,kCAAQ,MAAK,QAAb,EAAuB,WAAU,sBAAjC;AAAA;AAAA;AADJ,yBAJJ;AAOI;AAAA;AAAA,8BAAQ,MAAK,QAAb,EAAsB,WAAU,gCAAhC,EAAiE,SAAS,KAAKe,GAAL,CAASM,IAAT,CAAc,IAAd,CAA1E;AACI,iEAAG,WAAU,gBAAb,GADJ;AAAA;AAAA;AAPJ;AAFJ,iBADJ;AAeI;AAAA;AAAA,sBAAK,WAAU,2BAAf;AACI;AAAA;AAAA,0BAAQ,WAAU,gCAAlB;AACI;AAAA;AAAA;AACA;AAAA;AAAA,kCAAI,MAAK,KAAT;AACI;AAAA;AAAA,sCAAI,WAAWrB,UAAUC,OAAV,IAAmB,IAAnB,GAAyBD,UAAUE,QAAV,IAAoB,CAApB,GAAsB,aAAtB,GAAoC,cAA7D,GAA6E,SAA5F,EAAuG,SAAS,KAAKS,YAAL,CAAkBU,IAAlB,CAAuB,IAAvB,EAA4B,IAA5B,CAAhH;AAAA;AAAA,iCADJ;AAEI;AAAA;AAAA,sCAAI,WAAWrB,UAAUC,OAAV,IAAmB,MAAnB,GAA2BD,UAAUE,QAAV,IAAoB,CAApB,GAAsB,aAAtB,GAAoC,cAA/D,GAA+E,SAA9F,EAAyG,SAAS,KAAKS,YAAL,CAAkBU,IAAlB,CAAuB,IAAvB,EAA4B,MAA5B,CAAlH;AAAA;AAAA,iCAFJ;AAGI;AAAA;AAAA,sCAAI,WAAWrB,UAAUC,OAAV,IAAmB,OAAnB,GAA4BD,UAAUE,QAAV,IAAoB,CAApB,GAAsB,aAAtB,GAAoC,cAAhE,GAAgF,SAA/F,EAA0G,SAAS,KAAKS,YAAL,CAAkBU,IAAlB,CAAuB,IAAvB,EAA4B,OAA5B,CAAnH;AAAA;AAAA,iCAHJ;AAKI;AAAA;AAAA,sCAAI,WAAWrB,UAAUC,OAAV,IAAmB,cAAnB,GAAmCD,UAAUE,QAAV,IAAoB,CAApB,GAAsB,aAAtB,GAAoC,cAAvE,GAAuF,SAAtG,EAAiH,SAAS,KAAKS,YAAL,CAAkBU,IAAlB,CAAuB,IAAvB,EAA4B,cAA5B,CAA1H;AAAA;AAAA,iCALJ;AAMI;AAAA;AAAA,sCAAI,WAAWrB,UAAUC,OAAV,IAAmB,gBAAnB,GAAqCD,UAAUE,QAAV,IAAoB,CAApB,GAAsB,aAAtB,GAAoC,cAAzE,GAAyF,SAAxG,EAAmH,SAAS,KAAKS,YAAL,CAAkBU,IAAlB,CAAuB,IAAvB,EAA4B,gBAA5B,CAA5H;AAAA;AAAA,iCANJ;AAOI;AAAA;AAAA,sCAAI,WAAWrB,UAAUC,OAAV,IAAmB,cAAnB,GAAmCD,UAAUE,QAAV,IAAoB,CAApB,GAAsB,aAAtB,GAAoC,cAAvE,GAAuF,SAAtG,EAAiH,SAAS,KAAKS,YAAL,CAAkBU,IAAlB,CAAuB,IAAvB,EAA4B,cAA5B,CAA1H;AAAA;AAAA,iCAPJ;AAQI;AAAA;AAAA,sCAAI,WAAWrB,UAAUC,OAAV,IAAmB,gBAAnB,GAAqCD,UAAUE,QAAV,IAAoB,CAApB,GAAsB,aAAtB,GAAoC,cAAzE,GAAyF,SAAxG,EAAmH,SAAS,KAAKS,YAAL,CAAkBU,IAAlB,CAAuB,IAAvB,EAA4B,gBAA5B,CAA5H;AAAA;AAAA;AARJ;AADA,yBADJ;AAaI;AAAA;AAAA;AACCF,uCAAWG,GAAX,CAAe,UAACC,SAAD,EAAYC,KAAZ;AAAA,uCACZ;AAAA;AAAA,sCAAI,KAAKA,KAAT;AACI;AAAA;AAAA;AAAI;AAAA;AAAA,8CAAM,IAAI,qBAAmBD,UAAUE,EAAvC;AAA4CF,sDAAUE;AAAtD;AAAJ,qCADJ;AAEI;AAAA;AAAA;AAAKF,kDAAUG;AAAf,qCAFJ;AAGI;AAAA;AAAA;AAAKH,kDAAUI;AAAf,qCAHJ;AAKI;AAAA;AAAA;AAAKJ,kDAAUK;AAAf,qCALJ;AAMI;AAAA;AAAA;AAAKL,kDAAUM;AAAf,qCANJ;AAOI;AAAA;AAAA;AAAKN,kDAAUO;AAAf,qCAPJ;AAQI;AAAA;AAAA;AAAKP,kDAAUQ;AAAf;AARJ,iCADY;AAAA,6BAAf;AADD;AAbJ;AADJ;AAfJ;AAFJ,SADJ;AAqEH,K;;;;;AAEL,SAASC,eAAT,CAAyBjC,KAAzB,EAAgC;AAC5B,WAAO;AACHoB,oBAAYpB,MAAMoB;AADf,KAAP;AAGH;AACD;AACA,SAASc,kBAAT,CAA4BC,QAA5B,EAAsC;AAClC,WAAO,2DAAsCA,QAAtC,CAAP;AACH;;AAED;kBACe,yBAAQF,eAAR,EAAyBC,kBAAzB,EAA6C,6BAAWpC,UAAX,CAA7C,C","file":"Challenges.js","sourcesContent":["/**\r\n * Created by qwr on 2017/9/18.\r\n */\r\nimport React, {Component, PropTypes} from 'react'\r\nimport Helmet from \"react-helmet\"\r\nimport {bindActionCreators} from 'redux'\r\nimport {connect} from 'react-redux'\r\nimport {Link, withRouter} from \"react-router\";\r\nimport {Col, Pagination} from \"react-bootstrap\"\r\nimport {challengesActions} from '../actions'\r\nimport Alert from '../components/Alert';\r\nclass Challenges extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            condition:{\r\n                sortKey:'id',\r\n                sortType:1, //1升0降\r\n            },\r\n        };\r\n    }\r\n    componentDidMount() {\r\n        var condition=this.props.location.query;\r\n        if(!condition.sortKey){\r\n            condition=this.state.condition;\r\n        }else{\r\n\r\n            this.setState({\r\n                condition:condition,\r\n            })\r\n        }\r\n        this.query(condition);\r\n    }\r\n    componentDidUpdate(prevProps, prevState) {\r\n\r\n    }\r\n    query(condition) {\r\n        const {queryChallenges} = this.props;\r\n        queryChallenges(condition);\r\n    }\r\n    setCondition(sortKey){\r\n        var condition=this.state.condition;\r\n        var sortType;\r\n\r\n        if(sortKey==condition.sortKey){\r\n            if(condition.sortType==1){\r\n                sortType=-1;\r\n            }else{\r\n                sortType=1;\r\n            }\r\n        }else{\r\n            sortType=1;\r\n        }\r\n\r\n        condition.sortKey=sortKey;\r\n        condition.sortType=sortType;\r\n\r\n        this.setState(condition);\r\n        this.query(condition);\r\n        this.props.router.replace({pathname: this.props.location.pathname, query: condition});\r\n    }\r\n    csv(){\r\n        window.location.href=\"/api/manage/yoga/challenge/csv\";\r\n    }\r\n    render() {\r\n        const challenges = this.props.challenges.list||[];\r\n        var condition=this.state.condition;\r\n        return (\r\n            <div>\r\n                <Helmet title=\"Challenges\"/>\r\n                <div className=\"box\">\r\n                    <div className=\"box-header\">\r\n                        <h3 className=\"box-title\">Challenges</h3>\r\n                        <div className=\"box-tools\">\r\n                            <Link to={'/challengesorders'}>\r\n                                <button type=\"button\"  className=\"btn  btn-default m-5\">Manage Challenge Order</button>\r\n                            </Link>\r\n                            <Link to={'/challengesedit/0'}>\r\n                                <button type=\"button\"  className=\"btn  btn-primary m-5\">Create New Challenge</button>\r\n                            </Link>\r\n                            <button type=\"button\" className=\"btn btn-success pull-right m-5\" onClick={this.csv.bind(this)}>\r\n                                <i className=\"fa fa-download\"></i>Export csv\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"box-body table-responsive\">\r\n                        <table  className=\"table table-bordered dataTable\">\r\n                            <thead>\r\n                            <tr role=\"row\">\r\n                                <th className={condition.sortKey=='id'?(condition.sortType==1?\"sorting_asc\":\"sorting_desc\"):'sorting'} onClick={this.setCondition.bind(this,'id')}>ID</th>\r\n                                <th className={condition.sortKey=='code'?(condition.sortType==1?\"sorting_asc\":\"sorting_desc\"):'sorting'} onClick={this.setCondition.bind(this,'code')}>Code</th>\r\n                                <th className={condition.sortKey=='title'?(condition.sortType==1?\"sorting_asc\":\"sorting_desc\"):'sorting'} onClick={this.setCondition.bind(this,'title')}>Title</th>\r\n                                {/*<th className={condition.sortKey=='duration'?(condition.sortType==1?\"sorting_asc\":\"sorting_desc\"):'sorting'} onClick={this.setCondition.bind(this,'duration')}>Sequence in Challenge Homepage</th>*/}\r\n                                <th className={condition.sortKey=='timesStarted'?(condition.sortType==1?\"sorting_asc\":\"sorting_desc\"):'sorting'} onClick={this.setCondition.bind(this,'timesStarted')}>times started</th>\r\n                                <th className={condition.sortKey=='timesCompleted'?(condition.sortType==1?\"sorting_asc\":\"sorting_desc\"):'sorting'} onClick={this.setCondition.bind(this,'timesCompleted')}>times completed</th>\r\n                                <th className={condition.sortKey=='usersStarted'?(condition.sortType==1?\"sorting_asc\":\"sorting_desc\"):'sorting'} onClick={this.setCondition.bind(this,'usersStarted')}>unique users started</th>\r\n                                <th className={condition.sortKey=='usersCompleted'?(condition.sortType==1?\"sorting_asc\":\"sorting_desc\"):'sorting'} onClick={this.setCondition.bind(this,'usersCompleted')}>unique users completed</th>\r\n                            </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                            {challenges.map((challenge, index) =>\r\n                                <tr key={index}>\r\n                                    <td><Link to={'/challengesedit/'+challenge.id}>{challenge.id}</Link></td>\r\n                                    <td>{challenge.code}</td>\r\n                                    <td>{challenge.title}</td>\r\n                                    {/*<td></td>*/}\r\n                                    <td>{challenge.startedTimes}</td>\r\n                                    <td>{challenge.completedTimes}</td>\r\n                                    <td>{challenge.startedUserCount}</td>\r\n                                    <td>{challenge.completedUserCount}</td>\r\n                                </tr>\r\n                            )}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n\r\n                    {/*<div className=\"box-footer clearfix\">\r\n                     <div className=\"pull-right\">\r\n                     <Pagination\r\n                     prev\r\n                     next\r\n                     first\r\n                     last\r\n                     ellipsis\r\n                     boundaryLinks\r\n                     items={3}\r\n                     maxButtons={5}\r\n                     activePage={this.state.activePage}\r\n                     onSelect={this.handleSelect.bind(this)}\r\n                     />\r\n                     </div>\r\n                     </div>*/}\r\n                </div>\r\n\r\n            </div>\r\n        )\r\n    }\r\n}\r\nfunction mapStateToProps(state) {\r\n    return {\r\n        challenges: state.challenges\r\n    }\r\n}\r\n//将action的所有方法绑定到props上\r\nfunction mapDispatchToProps(dispatch) {\r\n    return bindActionCreators(challengesActions, dispatch)\r\n}\r\n\r\n//通过react-redux提供的connect方法将我们需要的state中的数据和actions中的方法绑定到props上\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(Challenges))"]}