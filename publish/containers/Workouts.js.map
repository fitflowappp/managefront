{"version":3,"sources":["../../src/containers/Workouts.js"],"names":["Workouts","props","state","condition","sortkey","sorttype","componentDidMount","location","query","setState","componentDidUpdate","prevProps","prevState","queryWorkouts","setCondition","Number","router","replace","pathname","copy","workout","copyWorkout","that","id","title","res","result","code","info","msg","render","workouts","list","bind","map","index","duration","mapStateToProps","mapDispatchToProps","dispatch"],"mappings":"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","file":"Workouts.js","sourcesContent":["/**\r\n * Created by qwr on 2017/9/15.\r\n */\r\nimport React, {Component, PropTypes} from 'react'\r\nimport Helmet from \"react-helmet\"\r\nimport {bindActionCreators} from 'redux'\r\nimport {connect} from 'react-redux'\r\nimport {Link, withRouter} from \"react-router\";\r\nimport {Col, Pagination} from \"react-bootstrap\"\r\nimport {workoutsActions} from '../actions'\r\nimport Alert from '../components/Alert';\r\nclass Workouts extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            condition:{\r\n                sortkey:'id',\r\n                sorttype:1, //1升0降\r\n            },\r\n        };\r\n    }\r\n    componentDidMount() {\r\n        var condition=this.props.location.query;\r\n        if(!condition.sortkey){\r\n            condition=this.state.condition;\r\n        }else{\r\n\r\n            this.setState({\r\n                condition:condition,\r\n            })\r\n        }\r\n        this.query(condition);\r\n    }\r\n    componentDidUpdate(prevProps, prevState) {\r\n\r\n    }\r\n    query(condition) {\r\n        const {queryWorkouts} = this.props;\r\n        queryWorkouts(condition);\r\n    }\r\n    setCondition(sortkey){\r\n        var condition=this.state.condition;\r\n        var sorttype;\r\n\r\n        if(sortkey==condition.sortkey){\r\n            sorttype=Number(!condition.sorttype);\r\n        }else{\r\n            sorttype=1;\r\n        }\r\n\r\n        condition.sortkey=sortkey;\r\n        condition.sorttype=sorttype;\r\n\r\n        this.setState(condition);\r\n        this.query(condition);\r\n        this.props.router.replace({pathname: this.props.location.pathname, query: condition});\r\n    }\r\n    copy(workout){\r\n        const {copyWorkout} = this.props;\r\n        const that=this;\r\n        copyWorkout({id:workout.id,title:workout.title},function (res) {\r\n            if(res.result.code==1){\r\n                that.query(that.state.condition);\r\n            }\r\n            Alert.info({info:res.result.msg});\r\n        });\r\n    }\r\n    render() {\r\n        const workouts = this.props.workouts.list||[];\r\n        var condition=this.state.condition;\r\n        return (\r\n            <div>\r\n                <Helmet title=\"Workouts\"/>\r\n                <div className=\"box\">\r\n                    <div className=\"box-header\">\r\n                        <h3 className=\"box-title\">Workouts</h3>\r\n                        <div className=\"box-tools\">\r\n                            <Link to={'/workoutsedit/0'}>\r\n                                <button type=\"button\"  className=\"btn  btn-primary m-5\">Create New Workout</button>\r\n                            </Link>\r\n                            <button type=\"button\" className=\"btn btn-success pull-right m-5\">\r\n                                <i className=\"fa fa-download\"></i>Export csv\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"box-body table-responsive\">\r\n                        <table  className=\"table table-bordered dataTable\">\r\n                            <thead>\r\n                            <tr role=\"row\">\r\n                                <th className={condition.sortkey=='id'?(condition.sorttype?\"sorting_asc\":\"sorting_desc\"):'sorting'} onClick={this.setCondition.bind(this,'id')}>ID</th>\r\n                                <th className={condition.sortkey=='code'?(condition.sorttype?\"sorting_asc\":\"sorting_desc\"):'sorting'} onClick={this.setCondition.bind(this,'code')}>Code</th>\r\n                                <th className={condition.sortkey=='title'?(condition.sorttype?\"sorting_asc\":\"sorting_desc\"):'sorting'} onClick={this.setCondition.bind(this,'title')}>Title</th>\r\n                                <th className={condition.sortkey=='duration'?(condition.sorttype?\"sorting_asc\":\"sorting_desc\"):'sorting'} onClick={this.setCondition.bind(this,'duration')}>Duration</th>\r\n                                <th className={condition.sortkey=='timesStarted'?(condition.sorttype?\"sorting_asc\":\"sorting_desc\"):'sorting'} onClick={this.setCondition.bind(this,'timesStarted')}>times started</th>\r\n                                <th className={condition.sortkey=='timesCompleted'?(condition.sorttype?\"sorting_asc\":\"sorting_desc\"):'sorting'} onClick={this.setCondition.bind(this,'timesCompleted')}>times completed</th>\r\n                                <th className={condition.sortkey=='usersStarted'?(condition.sorttype?\"sorting_asc\":\"sorting_desc\"):'sorting'} onClick={this.setCondition.bind(this,'usersStarted')}>unique users started</th>\r\n                                <th className={condition.sortkey=='usersCompleted'?(condition.sorttype?\"sorting_asc\":\"sorting_desc\"):'sorting'} onClick={this.setCondition.bind(this,'usersCompleted')}>unique users completed</th>\r\n                                <th className={condition.sortkey=='durationWatched'?(condition.sorttype?\"sorting_asc\":\"sorting_desc\"):'sorting'} onClick={this.setCondition.bind(this,'durationWatched')}>Total duration of being watched</th>\r\n                                <th></th>\r\n                            </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                            {workouts.map((workout, index) =>\r\n                                <tr key={index}>\r\n                                    <td><Link to={'/workoutsedit/'+workout.id}>{workout.id}</Link></td>\r\n                                    <td>{workout.code}</td>\r\n                                    <td>{workout.title}</td>\r\n                                    <td>{workout.duration}</td>\r\n                                    <td></td>\r\n                                    <td></td>\r\n                                    <td></td>\r\n                                    <td></td>\r\n                                    <td></td>\r\n                                    <td>\r\n                                        <button type=\"button\"  className=\"btn  btn-default m-5\" onClick={this.copy.bind(this,workout)}>copy</button>\r\n                                    </td>\r\n                                </tr>\r\n                            )}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n\r\n                    {/*<div className=\"box-footer clearfix\">\r\n                     <div className=\"pull-right\">\r\n                     <Pagination\r\n                     prev\r\n                     next\r\n                     first\r\n                     last\r\n                     ellipsis\r\n                     boundaryLinks\r\n                     items={3}\r\n                     maxButtons={5}\r\n                     activePage={this.state.activePage}\r\n                     onSelect={this.handleSelect.bind(this)}\r\n                     />\r\n                     </div>\r\n                     </div>*/}\r\n                </div>\r\n\r\n            </div>\r\n        )\r\n    }\r\n}\r\nfunction mapStateToProps(state) {\r\n    return {\r\n        workouts: state.workouts\r\n    }\r\n}\r\n//将action的所有方法绑定到props上\r\nfunction mapDispatchToProps(dispatch) {\r\n    return bindActionCreators(workoutsActions, dispatch)\r\n}\r\n\r\n//通过react-redux提供的connect方法将我们需要的state中的数据和actions中的方法绑定到props上\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(Workouts))"]}